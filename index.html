<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stickman Platformer</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #222;
    }
    canvas {
      display: block;
      background: #333;
    }
    .btn {
      position: fixed;
      bottom: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: none;
      font-size: 20px;
      font-weight: bold;
      color: white;
      background: #555;
      opacity: 0.8;
      z-index: 10;
    }
    #left { left: 20px; }
    #right { left: 100px; }
    #jump { right: 20px; background: #888; }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <button id="left" class="btn">&#9664;</button>
  <button id="right" class="btn">&#9654;</button>
  <button id="jump" class="btn">&#8679;</button>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let W = canvas.width = window.innerWidth;
    let H = canvas.height = window.innerHeight;

    let gravity = 0.6;
    let keys = { left: false, right: false, jump: false };

    const player = {
      x: 50, y: H - 150,
      w: 30, h: 50,
      vx: 0, vy: 0,
      grounded: false,
      draw() {
        ctx.fillStyle = "#0f0";
        ctx.beginPath();
        // Head
        ctx.arc(this.x + this.w/2, this.y, 10, 0, Math.PI * 2);
        ctx.fill();
        // Body
        ctx.beginPath();
        ctx.moveTo(this.x + this.w/2, this.y + 10);
        ctx.lineTo(this.x + this.w/2, this.y + 35);
        // Arms
        ctx.moveTo(this.x + this.w/2, this.y + 15);
        ctx.lineTo(this.x + this.w/2 - 10, this.y + 25);
        ctx.moveTo(this.x + this.w/2, this.y + 15);
        ctx.lineTo(this.x + this.w/2 + 10, this.y + 25);
        // Legs
        ctx.moveTo(this.x + this.w/2, this.y + 35);
        ctx.lineTo(this.x + this.w/2 - 10, this.y + 50);
        ctx.moveTo(this.x + this.w/2, this.y + 35);
        ctx.lineTo(this.x + this.w/2 + 10, this.y + 50);
        ctx.strokeStyle = "#0f0";
        ctx.lineWidth = 3;
        ctx.stroke();
      },
      update() {
        if (keys.left) this.vx = -3;
        else if (keys.right) this.vx = 3;
        else this.vx = 0;

        this.vy += gravity;
        this.x += this.vx;
        this.y += this.vy;

        this.grounded = false;
        for (let plat of platforms) {
          if (
            this.x + this.w > plat.x && this.x < plat.x + plat.w &&
            this.y + this.h >= plat.y && this.y + this.h <= plat.y + plat.h &&
            this.vy >= 0
          ) {
            this.y = plat.y - this.h;
            this.vy = 0;
            this.grounded = true;
          }
        }

        // Win zone
        if (
          this.x + this.w > goal.x && this.x < goal.x + goal.w &&
          this.y + this.h > goal.y && this.y < goal.y + goal.h
        ) {
          alert("You win!");
          location.reload();
        }

        // Fall
        if (this.y > H) {
          alert("You fell!");
          location.reload();
        }
      }
    };

    const platforms = [];
    for (let i = 0; i < 8; i++) {
      let px = 100 + i * 150;
      let py = H - (100 + (i * 70));
      platforms.push({ x: px, y: py, w: 100, h: 10 });
    }

    const goal = { x: platforms[platforms.length - 1].x + 50, y: platforms[platforms.length - 1].y - 40, w: 40, h: 40 };

    function drawPlatforms() {
      ctx.fillStyle = "#888";
      platforms.forEach(p => {
        ctx.fillRect(p.x, p.y, p.w, p.h);
      });
    }

    function drawGoal() {
      ctx.fillStyle = "#ff0";
      ctx.fillRect(goal.x, goal.y, goal.w, goal.h);
    }

    function gameLoop() {
      ctx.clearRect(0, 0, W, H);
      drawPlatforms();
      drawGoal();
      player.update();
      player.draw();
      requestAnimationFrame(gameLoop);
    }

    gameLoop();

    document.getElementById("left").addEventListener("touchstart", () => keys.left = true);
    document.getElementById("left").addEventListener("touchend", () => keys.left = false);
    document.getElementById("right").addEventListener("touchstart", () => keys.right = true);
    document.getElementById("right").addEventListener("touchend", () => keys.right = false);
    document.getElementById("jump").addEventListener("touchstart", () => {
      if (player.grounded) {
        player.vy = -12;
        player.grounded = false;
      }
    });

    window.addEventListener("resize", () => {
      W = canvas.width = window.innerWidth;
      H = canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>